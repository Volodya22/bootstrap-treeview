!function(j,i,p,o){var n="treeview",m={};m.settings={injectStyle:!0,levels:2,expandIcon:"glyphicon glyphicon-plus",collapseIcon:"glyphicon glyphicon-minus",emptyIcon:"glyphicon",nodeIcon:"",selectedIcon:"",checkedIcon:"glyphicon glyphicon-check",uncheckedIcon:"glyphicon glyphicon-unchecked",color:o,backColor:o,borderColor:o,onhoverColor:"#F5F5F5",selectedColor:"#FFFFFF",selectedBackColor:"#428bca",searchResultColor:"#D9534F",searchResultBackColor:o,enableLinks:!1,highlightSelected:!0,highlightSearchResults:!0,showBorder:!0,showIcon:!0,showCheckbox:!1,showTags:!1,multiSelect:!1,onLoading:o,onLoadingFailed:o,onInitialized:o,onNodeChecked:o,onNodeCollapsed:o,onNodeDisabled:o,onNodeEnabled:o,onNodeExpanded:o,onNodeSelected:o,onNodeUnchecked:o,onNodeUnselected:o,onSearchComplete:o,onSearchCleared:o},m.options={silent:!1,ignoreChildren:!1},m.searchOptions={ignoreCase:!0,exactMatch:!1,revealResults:!0},m.dataUrl={method:"GET",dataType:"json",cache:!1};var l=function(a,d){return this.$element=j(a),this.elementId=a.id,this.styleId=this.elementId+"-style",this.init(d),{options:this.options,init:j.proxy(this.init,this),remove:j.proxy(this.remove,this),getNode:j.proxy(this.getNode,this),getParent:j.proxy(this.getParent,this),getSiblings:j.proxy(this.getSiblings,this),getSelected:j.proxy(this.getSelected,this),getUnselected:j.proxy(this.getUnselected,this),getExpanded:j.proxy(this.getExpanded,this),getCollapsed:j.proxy(this.getCollapsed,this),getChecked:j.proxy(this.getChecked,this),getUnchecked:j.proxy(this.getUnchecked,this),getDisabled:j.proxy(this.getDisabled,this),getEnabled:j.proxy(this.getEnabled,this),selectNode:j.proxy(this.selectNode,this),unselectNode:j.proxy(this.unselectNode,this),toggleNodeSelected:j.proxy(this.toggleNodeSelected,this),collapseAll:j.proxy(this.collapseAll,this),collapseNode:j.proxy(this.collapseNode,this),expandAll:j.proxy(this.expandAll,this),expandNode:j.proxy(this.expandNode,this),toggleNodeExpanded:j.proxy(this.toggleNodeExpanded,this),revealNode:j.proxy(this.revealNode,this),checkAll:j.proxy(this.checkAll,this),checkNode:j.proxy(this.checkNode,this),uncheckAll:j.proxy(this.uncheckAll,this),uncheckNode:j.proxy(this.uncheckNode,this),toggleNodeChecked:j.proxy(this.toggleNodeChecked,this),disableAll:j.proxy(this.disableAll,this),disableNode:j.proxy(this.disableNode,this),enableAll:j.proxy(this.enableAll,this),enableNode:j.proxy(this.enableNode,this),toggleNodeDisabled:j.proxy(this.toggleNodeDisabled,this),search:j.proxy(this.search,this),clearSearch:j.proxy(this.clearSearch,this)}};l.prototype.init=function(a){this.tree=[],this.nodes=[],this.initialized=!1,this.options=j.extend({},m.settings,a),this.destroy(),this.subscribeEvents(),this.triggerEvent("loading",null,m.options);this.load(a).then(j.proxy(function(b){return this.tree=j.extend(true,[],b)},this),j.proxy(function(b){this.triggerEvent("loadingFailed",b,m.options)},this)).then(j.proxy(function(b){return this.setInitialStates({nodes:b},0)},this)).then(j.proxy(function(){this.render()},this))},l.prototype.load=function(a){var c=new j.Deferred();if(a.data){this.loadLocalData(a,c)}else{if(a.dataUrl){this.loadRemoteData(a,c)}}return c.promise()},l.prototype.loadRemoteData=function(a,c){j.ajax(j.extend(true,{},m.dataUrl,a.dataUrl)).done(function(b){c.resolve(b)}).fail(function(e,b,d){c.reject(d)})},l.prototype.loadLocalData=function(a,c){c.resolve((typeof a.data==="string")?j.parseJSON(a.data):j.extend(true,[],a.data))},l.prototype.remove=function(){this.destroy(),j.removeData(this,n),j("#"+this.styleId).remove()},l.prototype.destroy=function(){this.initialized&&(this.$wrapper.remove(),this.$wrapper=null,this.unsubscribeEvents(),this.initialized=!1)},l.prototype.unsubscribeEvents=function(){this.$element.off("click"),this.$element.off("loading"),this.$element.off("loadingFailed"),this.$element.off("initialized"),this.$element.off("nodeChecked"),this.$element.off("nodeCollapsed"),this.$element.off("nodeDisabled"),this.$element.off("nodeEnabled"),this.$element.off("nodeExpanded"),this.$element.off("nodeSelected"),this.$element.off("nodeUnchecked"),this.$element.off("nodeUnselected"),this.$element.off("searchComplete"),this.$element.off("searchCleared")},l.prototype.subscribeEvents=function(){this.unsubscribeEvents(),this.$element.on("click",j.proxy(this.clickHandler,this)),"function"==typeof this.options.onLoading&&this.$element.on("loading",this.options.onLoading),"function"==typeof this.options.onLoadingFailed&&this.$element.on("loadingFailed",this.options.onLoadingFailed),"function"==typeof this.options.onInitialized&&this.$element.on("initialized",this.options.onInitialized),"function"==typeof this.options.onNodeChecked&&this.$element.on("nodeChecked",this.options.onNodeChecked),"function"==typeof this.options.onNodeCollapsed&&this.$element.on("nodeCollapsed",this.options.onNodeCollapsed),"function"==typeof this.options.onNodeDisabled&&this.$element.on("nodeDisabled",this.options.onNodeDisabled),"function"==typeof this.options.onNodeEnabled&&this.$element.on("nodeEnabled",this.options.onNodeEnabled),"function"==typeof this.options.onNodeExpanded&&this.$element.on("nodeExpanded",this.options.onNodeExpanded),"function"==typeof this.options.onNodeSelected&&this.$element.on("nodeSelected",this.options.onNodeSelected),"function"==typeof this.options.onNodeUnchecked&&this.$element.on("nodeUnchecked",this.options.onNodeUnchecked),"function"==typeof this.options.onNodeUnselected&&this.$element.on("nodeUnselected",this.options.onNodeUnselected),"function"==typeof this.options.onSearchComplete&&this.$element.on("searchComplete",this.options.onSearchComplete),"function"==typeof this.options.onSearchCleared&&this.$element.on("searchCleared",this.options.onSearchCleared)},l.prototype.triggerEvent=function(d,a,e){if(e&&!e.silent){this.$element.trigger(d,j.extend(1,{},a))}},l.prototype.setInitialStates=function(a,h){if(a.nodes){h+=1;var g=a,f=this;j.each(a.nodes,function(d,c){c.nodeId=f.nodes.length,c.parentId=g.nodeId,c.hasOwnProperty("selectable")||(c.selectable=!0),c.state=c.state||{},c.state.hasOwnProperty("checked")||(c.state.checked=!1),c.state.hasOwnProperty("disabled")||(c.state.disabled=!1),c.state.hasOwnProperty("expanded")||(!c.state.disabled&&h<f.options.levels&&c.nodes&&c.nodes.length>0?c.state.expanded=!0:c.state.expanded=!1),c.state.hasOwnProperty("selected")||(c.state.selected=!1),f.nodes.push(c),c.nodes&&f.setInitialStates(c,h)})}},l.prototype.clickHandler=function(a){this.options.enableLinks||a.preventDefault();var h=j(a.target),g=this.findNode(h);if(g&&!g.state.disabled){var f=h.attr("class")?h.attr("class").split(" "):[];-1!==f.indexOf("expand-icon")?(this.toggleExpandedState(g,m.options),this.render()):-1!==f.indexOf("check-icon")?(this.toggleCheckedState(g,m.options),this.render()):(g.selectable?this.toggleSelectedState(g,m.options):this.toggleExpandedState(g,m.options),this.render())}},l.prototype.findNode=function(e){var d=e.closest("li.list-group-item").attr("data-nodeid"),f=this.nodes[d];return f||console.log("Error: node does not exist"),f},l.prototype.toggleExpandedState=function(d,c){d&&this.setExpandedState(d,!d.state.expanded,c)},l.prototype.setExpandedState=function(a,f,e){f!==a.state.expanded&&(f&&a.nodes?(a.state.expanded=!0,e.silent||this.$element.trigger("nodeExpanded",j.extend(!0,{},a))):f||(a.state.expanded=!1,e.silent||this.$element.trigger("nodeCollapsed",j.extend(!0,{},a)),a.nodes&&!e.ignoreChildren&&j.each(a.nodes,j.proxy(function(d,c){this.setExpandedState(c,!1,e)},this))))},l.prototype.toggleSelectedState=function(d,c){d&&this.setSelectedState(d,!d.state.selected,c)},l.prototype.setSelectedState=function(a,f,e){f!==a.state.selected&&(f?(this.options.multiSelect||j.each(this.findNodes("true","g","state.selected"),j.proxy(function(d,c){this.setSelectedState(c,!1,e)},this)),a.state.selected=!0,e.silent||this.$element.trigger("nodeSelected",j.extend(!0,{},a))):(a.state.selected=!1,e.silent||this.$element.trigger("nodeUnselected",j.extend(!0,{},a))))},l.prototype.toggleCheckedState=function(d,c){d&&this.setCheckedState(d,!d.state.checked,c)},l.prototype.setCheckedState=function(a,f,e){f!==a.state.checked&&(f?(a.state.checked=!0,e.silent||this.$element.trigger("nodeChecked",j.extend(!0,{},a))):(a.state.checked=!1,e.silent||this.$element.trigger("nodeUnchecked",j.extend(!0,{},a))))},l.prototype.setDisabledState=function(a,f,e){f!==a.state.disabled&&(f?(a.state.disabled=!0,this.setExpandedState(a,!1,e),this.setSelectedState(a,!1,e),this.setCheckedState(a,!1,e),e.silent||this.$element.trigger("nodeDisabled",j.extend(!0,{},a))):(a.state.disabled=!1,e.silent||this.$element.trigger("nodeEnabled",j.extend(!0,{},a))))},l.prototype.render=function(){this.initialized||(this.$element.addClass(n),this.$wrapper=j(this.template.list),this.injectStyle(),this.initialized=!0),this.$element.empty().append(this.$wrapper.empty()),this.buildTree(this.tree,0)},l.prototype.buildTree=function(a,f){if(a){f+=1;var e=this;j.each(a,function(c,s){for(var r=j(e.template.item).addClass("node-"+e.elementId).addClass(s.state.checked?"node-checked":"").addClass(s.state.disabled?"node-disabled":"").addClass(s.state.selected?"node-selected":"").addClass(s.searchResult?"search-result":"").attr("data-nodeid",s.nodeId).attr("style",e.buildStyleOverride(s)),q=0;f-1>q;q++){r.append(e.template.indent)}var d=[];if(s.nodes?(d.push("expand-icon"),d.push(s.state.expanded?e.options.collapseIcon:e.options.expandIcon)):d.push(e.options.emptyIcon),r.append(j(e.template.icon).addClass(d.join(" "))),e.options.showIcon){var d=["node-icon"];d.push(s.icon||e.options.nodeIcon),s.state.selected&&(d.pop(),d.push(s.selectedIcon||e.options.selectedIcon||s.icon||e.options.nodeIcon)),r.append(j(e.template.icon).addClass(d.join(" ")))}if(e.options.showCheckbox){var d=["check-icon"];d.push(s.state.checked?e.options.checkedIcon:e.options.uncheckedIcon),r.append(j(e.template.icon).addClass(d.join(" ")))}return r.append(e.options.enableLinks?j(e.template.link).attr("href",s.href).append(s.text):s.text),e.options.showTags&&s.tags&&j.each(s.tags,function(g,h){r.append(j(e.template.badge).append(h))}),e.$wrapper.append(r),s.nodes&&s.state.expanded&&!s.state.disabled?e.buildTree(s.nodes,f):void 0})}},l.prototype.buildStyleOverride=function(e){if(e.state.disabled){return""}var d=e.color,f=e.backColor;return this.options.highlightSelected&&e.state.selected&&(this.options.selectedColor&&(d=this.options.selectedColor),this.options.selectedBackColor&&(f=this.options.selectedBackColor)),this.options.highlightSearchResults&&e.searchResult&&!e.state.disabled&&(this.options.searchResultColor&&(d=this.options.searchResultColor),this.options.searchResultBackColor&&(f=this.options.searchResultBackColor)),"color:"+d+";background-color:"+f+";"},l.prototype.injectStyle=function(){this.options.injectStyle&&!p.getElementById(this.styleId)&&j('<style type="text/css" id="'+this.styleId+'"> '+this.buildStyle()+" </style>").appendTo("head")},l.prototype.buildStyle=function(){var b=".node-"+this.elementId+"{";return this.options.color&&(b+="color:"+this.options.color+";"),this.options.backColor&&(b+="background-color:"+this.options.backColor+";"),this.options.showBorder?this.options.borderColor&&(b+="border:1px solid "+this.options.borderColor+";"):b+="border:none;",b+="}",this.options.onhoverColor&&(b+=".node-"+this.elementId+":not(.node-disabled):hover{background-color:"+this.options.onhoverColor+";}"),this.css+b},l.prototype.template={list:'<ul class="list-group"></ul>',item:'<li class="list-group-item"></li>',indent:'<span class="indent"></span>',icon:'<span class="icon"></span>',link:'<a href="#" style="color:inherit;"></a>',badge:'<span class="badge"></span>'},l.prototype.css=".treeview .list-group-item{cursor:pointer}.treeview span.indent{margin-left:10px;margin-right:10px}.treeview span.icon{width:12px;margin-right:5px}.treeview .node-disabled{color:silver;cursor:not-allowed}",l.prototype.getNode=function(b){return this.nodes[b]},l.prototype.getParent=function(d){var c=this.identifyNode(d);return this.nodes[c.parentId]},l.prototype.getSiblings=function(f){var e=this.identifyNode(f),h=this.getParent(e),g=h?h.nodes:this.tree;return g.filter(function(b){return b.nodeId!==e.nodeId})},l.prototype.getSelected=function(){return this.findNodes("true","g","state.selected")},l.prototype.getUnselected=function(){return this.findNodes("false","g","state.selected")},l.prototype.getExpanded=function(){return this.findNodes("true","g","state.expanded")},l.prototype.getCollapsed=function(){return this.findNodes("false","g","state.expanded")},l.prototype.getChecked=function(){return this.findNodes("true","g","state.checked")},l.prototype.getUnchecked=function(){return this.findNodes("false","g","state.checked")},l.prototype.getDisabled=function(){return this.findNodes("true","g","state.disabled")},l.prototype.getEnabled=function(){return this.findNodes("false","g","state.disabled")},l.prototype.selectNode=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(e,c){this.setSelectedState(e,!0,c)},this)),this.render()},l.prototype.unselectNode=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(e,c){this.setSelectedState(e,!1,c)},this)),this.render()},l.prototype.toggleNodeSelected=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(e,c){this.toggleSelectedState(e,c)},this)),this.render()},l.prototype.collapseAll=function(a){var d=this.findNodes("true","g","state.expanded");this.forEachIdentifier(d,a,j.proxy(function(e,c){this.setExpandedState(e,!1,c)},this)),this.render()},l.prototype.collapseNode=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(e,c){this.setExpandedState(e,!1,c)},this)),this.render()},l.prototype.expandAll=function(a){if(a=j.extend({},m.options,a),a&&a.levels){this.expandLevels(this.tree,a.levels,a)}else{var d=this.findNodes("false","g","state.expanded");this.forEachIdentifier(d,a,j.proxy(function(e,c){this.setExpandedState(e,!0,c)},this))}this.render()},l.prototype.expandNode=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(e,c){this.setExpandedState(e,!0,c),e.nodes&&c&&c.levels&&this.expandLevels(e.nodes,c.levels-1,c)},this)),this.render()},l.prototype.expandLevels=function(a,f,e){e=j.extend({},m.options,e),j.each(a,j.proxy(function(d,c){this.setExpandedState(c,f>0?!0:!1,e),c.nodes&&this.expandLevels(c.nodes,f-1,e)},this))},l.prototype.revealNode=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(f,e){for(var g=this.getParent(f);g;){this.setExpandedState(g,!0,e),g=this.getParent(g)}},this)),this.render()},l.prototype.toggleNodeExpanded=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(e,c){this.toggleExpandedState(e,c)},this)),this.render()},l.prototype.checkAll=function(a){var d=this.findNodes("false","g","state.checked");this.forEachIdentifier(d,a,j.proxy(function(e,c){this.setCheckedState(e,!0,c)},this)),this.render()},l.prototype.checkNode=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(e,c){this.setCheckedState(e,!0,c)},this)),this.render()},l.prototype.uncheckAll=function(a){var d=this.findNodes("true","g","state.checked");this.forEachIdentifier(d,a,j.proxy(function(e,c){this.setCheckedState(e,!1,c)},this)),this.render()},l.prototype.uncheckNode=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(e,c){this.setCheckedState(e,!1,c)},this)),this.render()},l.prototype.toggleNodeChecked=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(e,c){this.toggleCheckedState(e,c)},this)),this.render()},l.prototype.disableAll=function(a){var d=this.findNodes("false","g","state.disabled");this.forEachIdentifier(d,a,j.proxy(function(e,c){this.setDisabledState(e,!0,c)},this)),this.render()},l.prototype.disableNode=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(e,c){this.setDisabledState(e,!0,c)},this)),this.render()},l.prototype.enableAll=function(a){var d=this.findNodes("true","g","state.disabled");this.forEachIdentifier(d,a,j.proxy(function(e,c){this.setDisabledState(e,!1,c)},this)),this.render()},l.prototype.enableNode=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(e,c){this.setDisabledState(e,!1,c)},this)),this.render()},l.prototype.toggleNodeDisabled=function(a,d){this.forEachIdentifier(a,d,j.proxy(function(e,c){this.setDisabledState(e,!e.state.disabled,c)},this)),this.render()},l.prototype.forEachIdentifier=function(a,f,e){f=j.extend({},m.options,f),a instanceof Array||(a=[a]),j.each(a,j.proxy(function(d,c){e(this.identifyNode(c),f)},this))},l.prototype.identifyNode=function(b){return"number"==typeof b?this.nodes[b]:b},l.prototype.search=function(a,h){h=j.extend({},m.searchOptions,h),this.clearSearch({render:!1});var g=[];if(a&&a.length>0){h.exactMatch&&(a="^"+a+"$");var f="g";h.ignoreCase&&(f+="i"),g=this.findNodes(a,f),j.each(g,function(d,c){c.searchResult=!0})}return h.revealResults?this.revealNode(g):this.render(),this.$element.trigger("searchComplete",j.extend(!0,{},g)),g},l.prototype.clearSearch=function(a){a=j.extend({},{render:!0},a);var d=j.each(this.findNodes("true","g","searchResult"),function(e,c){c.searchResult=!1});a.render&&this.render(),this.$element.trigger("searchCleared",j.extend(!0,{},d))},l.prototype.findNodes=function(a,h,g){h=h||"g",g=g||"text";var f=this;return j.grep(this.nodes,function(b){var c=f.getNodeValue(b,g);return"string"==typeof c?c.match(new RegExp(a,h)):void 0})},l.prototype.getNodeValue=function(g,d){var r=d.indexOf(".");if(r>0){var q=g[d.substring(0,r)],h=d.substring(r+1,d.length);return this.getNodeValue(q,h)}return g.hasOwnProperty(d)?g[d].toString():o};var k=function(b){i.console&&i.console.error(b)};j.fn[n]=function(a,f){var e;return this.each(function(){var b=j.data(this,n);"string"==typeof a?b?j.isFunction(b[a])&&"_"!==a.charAt(0)?(f instanceof Array||(f=[f]),e=b[a].apply(b,f)):k("No such method : "+a):k("Not initialized, can not call method : "+a):"boolean"==typeof a?e=b:j.data(this,n,new l(this,j.extend(!0,{},a)))}),e||this}}(jQuery,window,document);
